(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[792],{4919:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(5155),l=a(2115),r=a(63);function n(e){let{blogs:t,onEdit:a,onDelete:l}=e;return(0,s.jsx)("div",{className:"overflow-x-auto shadow-lg rounded-lg",children:(0,s.jsxs)("table",{className:"w-full table-auto border border-gray-300 bg-white",children:[(0,s.jsx)("thead",{className:"bg-gray-100 text-left",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"border px-4 py-2",children:"Title"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Author"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Status"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Category"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Tags"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Featured"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Publish Date"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Attachments"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:t.map(e=>{var t,r;return(0,s.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,s.jsx)("td",{className:"border px-4 py-2 font-medium",children:e.title}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.author?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"font-medium",children:e.author.name}),e.author.email&&(0,s.jsxs)("span",{className:"text-gray-500 text-sm",children:[" (",e.author.email,")"]})]}):"Unknown"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.status||"draft"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.category||"-"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:(null==(t=e.tags)?void 0:t.join(", "))||"-"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.featured?"Yes":"No"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.publishDate?new Date(e.publishDate).toLocaleDateString():"-"}),(0,s.jsx)("td",{className:"border px-4 py-2",children:(null==(r=e.attachments)?void 0:r.length)?(0,s.jsx)("div",{className:"flex space-x-2",children:e.attachments.map((e,t)=>e.endsWith(".pdf")?(0,s.jsx)("a",{href:e,target:"_blank",className:"text-blue-500 underline",children:"PDF"},t):e.endsWith(".mp4")?(0,s.jsx)("a",{href:e,target:"_blank",className:"text-green-500 underline",children:"Video"},t):(0,s.jsx)("img",{src:e,alt:"Attachment",className:"w-12 h-12 object-cover rounded"},t))}):"-"}),(0,s.jsxs)("td",{className:"border px-4 py-2 space-x-2",children:[(0,s.jsx)("button",{onClick:()=>a(e),className:"bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600 transition",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>l(e.id),className:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition",children:"Delete"})]})]},e.id)})})]})})}function d(e){let{totalPages:t,currentPage:a,onPageChange:l}=e;return t<=1?null:(0,s.jsx)("div",{className:"flex justify-center mt-4 gap-2",children:Array.from({length:t},(e,t)=>t+1).map(e=>(0,s.jsx)("button",{"aria-label":"Go to page ".concat(e),onClick:()=>l(e),className:"px-3 py-1 rounded border ".concat(a===e?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300"),children:e},e))})}function o(){let e=(0,r.useRouter)(),[t,a]=(0,l.useState)([]),[o,c]=(0,l.useState)(!0),[i,h]=(0,l.useState)(null),[x,u]=(0,l.useState)(""),[p,m]=(0,l.useState)(1),[b,g]=(0,l.useState)(1);(0,l.useEffect)(()=>{j(p,x)},[p,x]);let j=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{c(!0),h(null);let s=await fetch("/api/admin/blogs?search=".concat(encodeURIComponent(t),"&page=").concat(e,"&limit=5"));if(!s.ok)throw Error("Failed to fetch blogs");let{blogs:l,total:r,page:n,limit:d}=await s.json();a(l),g(Math.ceil(r/d)),m(n)}catch(e){h("Failed to fetch blogs")}finally{c(!1)}},y=async e=>{if(confirm("Are you sure you want to delete this blog?")){a(t=>t.filter(t=>t.id!==e));try{if(!(await fetch("/api/admin/blogs/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete")}catch(e){alert("Delete failed"),a(t)}}};return(0,s.jsxs)("div",{className:"p-6 bg-gray-100 min-h-screen",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Manage Blogs"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",placeholder:"Search blogs...",value:x,onChange:e=>{u(e.target.value),m(1)},className:"px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400"}),(0,s.jsx)("button",{onClick:()=>e.push("/admin/blogs/add"),className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",children:"Add Blog"})]})]}),o?(0,s.jsx)("p",{children:"Loading blogs..."}):i?(0,s.jsx)("p",{className:"text-red-500",children:i}):0===t.length?(0,s.jsx)("p",{children:"No blogs found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n,{blogs:t,onEdit:t=>e.push("/admin/blogs/".concat(t.id)),onDelete:y}),(0,s.jsx)(d,{totalPages:b,currentPage:p,onPageChange:e=>m(e)})]})]})}},5933:(e,t,a)=>{Promise.resolve().then(a.bind(a,4919))}},e=>{e.O(0,[96,76,358],()=>e(e.s=5933)),_N_E=e.O()}]);